!function(a,b){"function"==typeof define&&define.amd?define([],function(){return b()}):"object"==typeof exports?module.exports=b():b()}(this,function(){function a(){"use strict";function a(a,b){this.name=a,this.isActive=!0,this.tables={},this.priority=b||0}function c(a){return Object.prototype.hasOwnProperty.call(b,a)}function d(a){return angular.isString(a)&&""!==a}function e(a){if(!d(a))throw new TypeError("Invalid type of a first argument, a non-empty string expected.");return c(a)&&b[a].isActive}function f(a,b){for(var c in b)b[c]&&b[c].constructor&&b[c].constructor===Object?(a[c]=a[c]||{},f(a[c],b[c])):a[c]=b[c];return a}function g(){var a=[];for(var c in b)b[c].isActive&&a.push(b[c]);return a.sort(function(a,b){return a.priority-b.priority}),a}a.prototype.parseUrl=function(a,b){return angular.isFunction(a)?a(this.name,b):a.replace(/\{part\}/g,this.name).replace(/\{lang\}/g,b)},a.prototype.getTable=function(a,b,c,d,e,f){var g=b.defer();if(this.tables[a])g.resolve(this.tables[a]);else{var h=this;c(angular.extend({method:"GET",url:this.parseUrl(e,a)},d)).success(function(b){h.tables[a]=b,g.resolve(b)}).error(function(){f?f(h.name,a).then(function(b){h.tables[a]=b,g.resolve(b)},function(){g.reject(h.name)}):g.reject(h.name)})}return g.promise};var b={};this.addPart=function(e,f){if(!d(e))throw new TypeError("Couldn't add part, part name has to be a string!");return c(e)||(b[e]=new a(e,f)),b[e].isActive=!0,this},this.setPart=function(e,f,g){if(!d(e))throw new TypeError("Couldn't set part.`lang` parameter has to be a string!");if(!d(f))throw new TypeError("Couldn't set part.`part` parameter has to be a string!");if("object"!=typeof g||null===g)throw new TypeError("Couldn't set part. `table` parameter has to be an object!");return c(f)||(b[f]=new a(f),b[f].isActive=!1),b[f].tables[e]=g,this},this.deletePart=function(a){if(!d(a))throw new TypeError("Couldn't delete part, first arg has to be string.");return c(a)&&(b[a].isActive=!1),this},this.isPartAvailable=e,this.$get=["$rootScope","$injector","$q","$http",function(h,i,j,k){var l=function(a){if(!d(a.key))throw new TypeError("Unable to load data, a key is not a non-empty string.");if(!d(a.urlTemplate)&&!angular.isFunction(a.urlTemplate))throw new TypeError("Unable to load data, a urlTemplate is not a non-empty string or not a function.");var b=a.loadFailureHandler;if(void 0!==b){if(!angular.isString(b))throw new Error("Unable to load data, a loadFailureHandler is not a string.");b=i.get(b)}var c=[],e=j.defer(),h=g();return angular.forEach(h,function(d){c.push(d.getTable(a.key,j,k,a.$http,a.urlTemplate,b)),d.urlTemplate=a.urlTemplate}),j.all(c).then(function(){var b={};angular.forEach(h,function(c){f(b,c.tables[a.key])}),e.resolve(b)},function(){e.reject(a.key)}),e.promise};return l.addPart=function(e,f){if(!d(e))throw new TypeError("Couldn't add part, first arg has to be a string");return c(e)?b[e].isActive||(b[e].isActive=!0,h.$emit("$translatePartialLoaderStructureChanged",e)):(b[e]=new a(e,f),h.$emit("$translatePartialLoaderStructureChanged",e)),l},l.deletePart=function(a,e){if(!d(a))throw new TypeError("Couldn't delete part, first arg has to be string");if(void 0===e)e=!1;else if("boolean"!=typeof e)throw new TypeError("Invalid type of a second argument, a boolean expected.");if(c(a)){var f=b[a].isActive;if(e){var g=i.get("$translate"),j=g.loaderCache();"string"==typeof j&&(j=i.get(j)),"object"==typeof j&&angular.forEach(b[a].tables,function(c,d){j.remove(b[a].parseUrl(b[a].urlTemplate,d))}),delete b[a]}else b[a].isActive=!1;f&&h.$emit("$translatePartialLoaderStructureChanged",a)}return l},l.isPartLoaded=function(a,c){return angular.isDefined(b[a])&&angular.isDefined(b[a].tables[c])},l.getRegisteredParts=function(){var a=[];return angular.forEach(b,function(b){b.isActive&&a.push(b.name)}),a},l.getPart=function(a){return b[a]},l.isPartAvailable=e,l}]}return angular.module("pascalprecht.translate").provider("$translatePartialLoader",a),a.displayName="$translatePartialLoader","pascalprecht.translate"});